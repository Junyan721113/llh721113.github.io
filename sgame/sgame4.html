<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>坦克射击</title>
		<script type="text/javascript">
			var bulletnum=0,enemynum=0,dirx=0,diry=0,started=0,score=0;
			var bx=new Array();
			var by=new Array();
			var bvx=new Array();
			var bvy=new Array();
			var enh=new Array();
			var enl=new Array();
			function move()
			{
				var x=window.event.clientX-200,y=window.event.clientY-250;
				var r=Math.sqrt(x*x+y*y);
				dirx=x/r;diry=y/r;
			}
			function start()
			{
				document.getElementById('bstart').style.visibility="hidden";
				document.getElementById('tank').style.visibility="visible";
				setInterval("fly();",10);
				setInterval("summon();",500);
				setTimeout("started=1;",10);
			}
			function fire()
			{
				if(started==0) return;
				bulletnum++;
				var bullet=document.createElement("div")
				bullet.id='b'+bulletnum;
				document.getElementById('bg').appendChild(bullet);
				bullet.style="position: absolute; top: 245px; left: 195px; height: 10px; width: 10px; border-radius: 5px; background: #FF8888; z-index: 150;"
				bx[bulletnum]=200;by[bulletnum]=250;
				bvx[bulletnum]=dirx;bvy[bulletnum]=diry;
			}
			function fly()
			{
				for(var i=1;i<=bulletnum;i++)
				{
					bx[i]+=bvx[i]*5;
					by[i]+=bvy[i]*5;
					document.getElementById('b'+i).style.left=bx[i]-5+'px';
					document.getElementById('b'+i).style.top=by[i]-5+'px';
					if(bx[i]<=5 || bx[i]>=995 || by[i]<=5 || by[i]>=495) delbul(i);
					for(var j=1;j<=enemynum;j++)
					{
						if((bx[i]-enl[j])*(bx[i]-enl[j])+(by[i]-enh[j])*(by[i]-enh[j])<=400)
						{
							delbul(i);
							delene(j);
							score++;
							document.getElementById('sc').innerHTML=score;
						}
					}
				}
				for(var i=1;i<=enemynum;i++)
				{
					enl[i]-=0.5;
					document.getElementById('e'+i).style.left=enl[i]-15+'px';
					if(enl[i]<=15) delene(i);
				}
			}
			function delbul(i)
			{
				if(i==bulletnum)
				{
					document.getElementById('bg').removeChild(document.getElementById('b'+i));
					bulletnum--;
				}
				else
				{
					document.getElementById('bg').removeChild(document.getElementById('b'+i));
					document.getElementById('b'+bulletnum).id='b'+i;
					bx[i]=bx[bulletnum];
					by[i]=by[bulletnum];
					bvx[i]=bvx[bulletnum];
					bvy[i]=bvy[bulletnum];
					bulletnum--;
				}
			}
			function delene(i)
			{
				if(i==enemynum)
				{
					document.getElementById('bg').removeChild(document.getElementById('e'+i));
					enemynum--;
				}
				else
				{
					document.getElementById('bg').removeChild(document.getElementById('e'+i));
					document.getElementById('e'+enemynum).id='e'+i;
					enl[i]=enl[enemynum];
					enh[i]=enh[enemynum];
					enemynum--;
				}
			}
			function summon()
			{
				enemynum++;
				var enemy=document.createElement('div');
				enh[enemynum]=(Math.random()*19260817)%470+15;
				enl[enemynum]=985;
				enemy.id='e'+enemynum;
				document.getElementById('bg').appendChild(enemy);
				enemy.style="position: absolute; left: 970px; height: 30px; width: 30px; border-radius: 15px; background: #FF4444; z-index: 125;"
				enemy.style.top=enh[enemynum]-15+'px';
			}
		</script>
	</head>
	<body>
		<div id="bg" onmousemove="move();" onmousedown="fire();" style="position: absolute; top: 0px; left: 0px; height: 500px; width: 1000px; background: #FFFF88; z-index: 0;">
			<button id="bstart" onclick="start();" style="position: absolute; top: 225px; left: 450px; height: 50px; width: 100px; border: 2px solid #888888; border-radius: 20px; z-index: 1000; user-select: none;">开始游戏</button>
			<div id="tank" style="position: absolute; top: 235px; left: 185px; height: 30px; width: 30px; border-radius: 25px; background: #008888; visibility: hidden; z-index: 100;"></div>
			<div id="sc" style="font-size: 50px; z-index: 120; position: absolute; top: 0px; left: 0px; user-select: none;">0</div>
		</div>
	</body>
</html>